<body style="background:black"><canvas id="cav" 
style="background:black"
onmousedown="change()"></canvas></body>
<script>
//参数区
var h=window.innerHeight,//690
	w=h/69*40,//400
	d=-1*h/2,f=w/100,
	ol=0,ot=0,
	a=w*0.4,
	b=a*0.7;
var ry=0.01,rx=0.007;
var fl=1;
//画图函数
function paint(){
con.fillStyle="black";
con.fillRect(0,0,w,h);
con.strokeStyle="red";
draw(p0,px,con);
con.strokeStyle="blue";
draw(p0,py,con);
con.strokeStyle="green";
draw(p0,pz,con);
con.strokeStyle="#20FAAA";
draw(p1,p2,con);
draw(p2,p3,con);
draw(p3,p4,con);
draw(p5,p6,con);
draw(p6,p7,con);
draw(p7,p8,con);
draw(p4,p8,con);
}
//东西区
function change(){
fl*=-1;
}
var cav=document.getElementById("cav");
cav.width=w;
cav.height=h;
var con=cav.getContext("2d");
con.lineWidth=0.7;
var p0=new p3d(0,0,0);
var px=new p3d(a,0,0);
var py=new p3d(0,a,0);
var pz=new p3d(0,0,a);
var p1=new p3d(b,b,b);
var p2=new p3d(-b,b,b);
var p3=new p3d(-b,-b,b);
var p4=new p3d(b,-b,b);
var p5=new p3d(b,b,-b);
var p6=new p3d(-b,b,-b);
var p7=new p3d(-b,-b,-b);
var p8=new p3d(b,-b,-b);
paint();
//框架区
function p3d(x,y,z){
this.x=x;
this.y=y;
this.z=z;
this.rotateX=function (angle){
var sinA=Math.sin(angle);
var cosA=Math.cos(angle);
var tz=this.z;
var ty=this.y;
this.y=ty*cosA-tz*sinA;
this.z=ty*sinA+tz*cosA;
};
this.rotateY=function (angle){
var sinA=Math.sin(angle);
var cosA=Math.cos(angle);
var tz=this.z;
var tx=this.x;
this.z=tz*cosA-tx*sinA;
this.x=tz*sinA+tx*cosA;
};
this.rotateXY=function (a1,a2){
this.rotateX(a1);
this.rotateY(a2);
};
}
function draw(p1,p2,con){
dL(
d*0.7*p1.y/(d+p1.z)+w/2,
h*0.75-(d*0.7*(p1.x+f)/(d+p1.z)),
d*0.7*p2.y/(d+p2.z)+w/2,
h*0.75-(d*0.7*(p2.x+f)/(d+p2.z)),
con
);
dL(
d*0.7*p1.y/(d+p1.z)+w/2,
h*0.25-(d*0.7*(p1.x-f)/(d+p1.z)),
d*0.7*p2.y/(d+p2.z)+w/2,
h*0.25-(d*0.7*(p2.x-f)/(d+p2.z)),
con
);
}
function dL(x1,y1,x2,y2,con){
con.beginPath();
con.moveTo(x1,y1);
con.lineTo(x2,y2);
con.closePath();
con.stroke();
}
//转动区
var interval = self.setInterval("rota()",10);
function rota(){
if(fl==-1)
	return;
var t=new Date().getSeconds();
rx=Math.cos(t*Math.PI/12)*0.02;
ry=Math.sin(t*Math.PI/12)*0.02;
px.rotateXY(rx,ry);
py.rotateXY(rx,ry);
pz.rotateXY(rx,ry);
p1.rotateXY(rx,ry);
p2.rotateXY(rx,ry);
p3.rotateXY(rx,ry);
p4.rotateXY(rx,ry);
p5.rotateXY(rx,ry);
p6.rotateXY(rx,ry);
p7.rotateXY(rx,ry);
p8.rotateXY(rx,ry);
paint();
}
</script>
